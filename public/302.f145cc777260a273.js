"use strict";(self.webpackChunksala_juegos_2022=self.webpackChunksala_juegos_2022||[]).push([[302],{8302:(P,d,i)=>{i.r(d),i.d(d,{PreguntadosBanderasModule:()=>x});var a=i(6895),p=i(7001);class g{constructor(s,t,o){this.id="",this.user_id=s,this.score=t,this.timestamp=o}getLiteralObjectRepresentation(){return{user_id:this.user_id,score:this.score,timestamp:this.timestamp}}}var e=i(4650),h=i(529);let m=(()=>{class n{constructor(t){this.http=t,this.url="https://restcountries.com/v3.1/all"}getCountries(){return this.http.get(this.url)}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(h.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var f=i(7566);let v=(()=>{class n{constructor(t){this.firestore=t,this.collectionPath="/banderas_scores",this.banderasScoresCollection=t.collection(this.collectionPath)}getDocuments(){return this.banderasScoresCollection.valueChanges({idField:"id"})}addDocument(t){return this.banderasScoresCollection.add(t)}updateDocument(t,o){return this.banderasScoresCollection.doc(t).update(o)}deleteDocument(t){return this.banderasScoresCollection.doc(t).delete()}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(f.ST))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var C=i(2557);const S=function(n,s){return{correct:n,incorrect:s}};function O(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"div",9),e.NdJ("click",function(){const l=e.CHM(t).index,u=e.oxw(2);return e.KtG(u.onSelectedOption(null==u.options[l]?null:u.options[l].optionObject.name.common))}),e._uU(1),e.qZA()}if(2&n){const t=s.$implicit,o=s.index,r=e.oxw(2);e.Q6J("ngClass",e.WLB(2,S,1==(null==t?null:t.status),2==(null==t?null:t.status))),e.xp6(1),e.hij(" ",null==r.options[o]?null:r.options[o].optionObject.name.common," ")}}function _(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"div",2)(1,"div",3)(2,"button",10),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.newTry())}),e._uU(3,"SIGUIENTE"),e.qZA()(),e.TgZ(4,"div",3)(5,"h5",11),e._uU(6,"Cr\xe9ditos Espaciales"),e.qZA()(),e.TgZ(7,"div",3)(8,"h4",12),e._uU(9),e.qZA()()()}if(2&n){const t=e.oxw(2);e.xp6(9),e.Oqu(t.playerScore.score)}}function y(n,s){if(1&n&&(e.TgZ(0,"div",1)(1,"div",2)(2,"div",3),e._UZ(3,"img",4),e.qZA()(),e.TgZ(4,"div",5)(5,"div",6),e.YNc(6,O,2,5,"div",7),e.qZA()(),e.YNc(7,_,10,1,"div",8),e.qZA()),2&n){const t=e.oxw();e.xp6(3),e.Q6J("src",null==t.selectedOption?null:t.selectedOption.optionObject.flags.png,e.LSH),e.xp6(3),e.Q6J("ngForOf",t.options),e.xp6(1),e.Q6J("ngIf",0!=t.options[0].status)}}var c=(()=>{return(n=c||(c={}))[n.pendant=0]="pendant",n[n.isCorrect=1]="isCorrect",n[n.isIncorrect=2]="isIncorrect",c;var n})();const I=[{path:"",children:[{path:"",component:(()=>{class n{constructor(t,o,r){this.countryService=t,this.scores=o,this.auth=r,this.countries=[],this.options=[],this.selectedOption={},this.winFlag=!1,this.playerScore={}}ngOnInit(){this.countryService.getCountries().subscribe(t=>{this.countries=t,this.setOptions(this.countries.map(o=>o),3,0)}),this.initScore()}setOptions(t,o,r){o>r?(this.options[-1*(o-r-o)]={optionObject:t.splice(this.getRandomIntInRange(0,t.length-1),1)[0],status:c.pendant},this.setOptions(t,o,++r)):this.selectedOption=this.options[this.getRandomIntInRange(0,this.options.length-1)]}getOption(t){return t[this.getRandomIntInRange(0,t.length-1)]}getRandomCountry(){return this.countries[this.getRandomIntInRange(0,this.countries.length-1)]}getRandomIntInRange(t,o){return Math.floor(Math.random()*(o-t+1))+t}onSelectedOption(t){this.updateOptions(),t==this.selectedOption?.optionObject.name.common?(this.winFlag=!0,this.playerScore.score++,this.updateScore()):(this.playerScore.score--,this.updateScore())}newTry(){this.winFlag=!1,this.setOptions(this.countries.map(t=>t),3,0)}updateOptions(){this.options.forEach(t=>{t&&(t.status=t?.optionObject.name.common==this.selectedOption?.optionObject.name.common?c.isCorrect:c.isIncorrect)})}selectRandomFlag(){return this.options[this.getRandomIntInRange(0,this.options.length-1)]?.optionObject.flags.png}initScore(){this.scores.getDocuments().subscribe(t=>{const o=t.filter(r=>r.user_id==this.auth.GetCurrentUserID());if(0==o.length){const r=new g(this.auth.GetCurrentUserID(),0,Date.now().toString());this.scores.addDocument(r.getLiteralObjectRepresentation()).then(l=>this.playerScore=r)}else this.playerScore=o[0]})}updateScore(){this.playerScore.timestamp=Date.now().toString(),this.scores.updateDocument(this.playerScore.id,this.playerScore)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(m),e.Y36(v),e.Y36(C.e))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-preguntados"]],decls:1,vars:1,consts:[["class","container mt-5",4,"ngIf"],[1,"container","mt-5"],[1,"row"],[1,"col-12","flagContainer"],["alt","flag-to-guess",3,"src"],[1,"row","align-items-center","justify-content-center"],[1,"container"],["class","game-opt",3,"ngClass","click",4,"ngFor","ngForOf"],["class","row",4,"ngIf"],[1,"game-opt",3,"ngClass","click"],[1,"btn","btn-success",3,"click"],[1,"mt-5"],[1,"alert","alert-info","mt-1"]],template:function(t,o){1&t&&e.YNc(0,y,8,3,"div",0),2&t&&e.Q6J("ngIf",null!=o.options[0])},dependencies:[a.mk,a.sg,a.O5],styles:[".game-opt[_ngcontent-%COMP%]{text-align:center;font-size:large;border-radius:5px;background-color:#0d0f45;color:#fff;width:65%;margin:1.5rem auto}.game-opt[_ngcontent-%COMP%]:hover{cursor:pointer}.game-opt[_ngcontent-%COMP%]:active{transform:scale(.8)}.flagContainer[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.correct[_ngcontent-%COMP%]{background-color:#267f26}.incorrect[_ngcontent-%COMP%]{background-color:#933131}"]}),n})()}]}];let b=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[p.Bz.forChild(I),p.Bz]}),n})(),x=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[a.ez,b]}),n})()}}]);