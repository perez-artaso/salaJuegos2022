"use strict";(self.webpackChunksala_juegos_2022=self.webpackChunksala_juegos_2022||[]).push([[505],{505:(O,c,a)=>{a.r(c),a.d(c,{ChatModule:()=>y});var i=a(6895),l=a(7001),e=a(4650),d=a(7566);let g=(()=>{class t{constructor(s){this.firestore=s,this.collectionPath="/chat_messages",this.chatMessagesCollection=s.collection(this.collectionPath)}getDocuments(){return this.chatMessagesCollection.valueChanges({idField:"id"})}addDocument(s){return this.chatMessagesCollection.add(s)}updateDocument(s,n){return this.chatMessagesCollection.doc(s).update(n)}deleteDocument(s){return this.chatMessagesCollection.doc(s).delete()}}return t.\u0275fac=function(s){return new(s||t)(e.LFG(d.ST))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var p=a(2557);let h=(()=>{class t{transform(s,...n){if(null!=s){const r=new Date(Number(s));return r.getDay().toString()+"/"+r.getMonth()+"/"+r.getFullYear()+" - "+r.getHours()+":"+r.getMinutes()+" hs"}}}return t.\u0275fac=function(s){return new(s||t)},t.\u0275pipe=e.Yjl({name:"readableDateFromTimestamp",type:t,pure:!0}),t})();const u=function(t,o){return{"input-row":t,"output-row":o}},f=function(t,o){return{"chat-message-input":t,"chat-message-output":o}};let C=(()=>{class t{constructor(){this.isFromCurrentUser=!1,this.message=null}ngOnInit(){}}return t.\u0275fac=function(s){return new(s||t)},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-message"]],inputs:{isFromCurrentUser:"isFromCurrentUser",message:"message"},decls:15,vars:21,consts:[[1,"row",3,"ngClass"],[1,"col-10","col-md-8","col-lg-5","col-xxl-4"],[1,"user-info-input"],[1,"message-date"],[3,"ngClass"]],template:function(s,n){1&s&&(e.TgZ(0,"div")(1,"div",0)(2,"div",1)(3,"div",2),e._uU(4),e.qZA()()(),e.TgZ(5,"div",0)(6,"div",1)(7,"div",3),e._uU(8),e.ALo(9,"readableDateFromTimestamp"),e.qZA()()(),e.TgZ(10,"div",0)(11,"div",1)(12,"div",4)(13,"p"),e._uU(14),e.qZA()()()()()),2&s&&(e.xp6(1),e.Q6J("ngClass",e.WLB(9,u,!n.isFromCurrentUser,n.isFromCurrentUser)),e.xp6(3),e.Oqu(null==n.message?null:n.message.from),e.xp6(1),e.Q6J("ngClass",e.WLB(12,u,!n.isFromCurrentUser,n.isFromCurrentUser)),e.xp6(3),e.Oqu(e.lcZ(9,7,null==n.message||null==n.message.timestamp?null:n.message.timestamp.toString())),e.xp6(2),e.Q6J("ngClass",e.WLB(15,u,!n.isFromCurrentUser,n.isFromCurrentUser)),e.xp6(2),e.Q6J("ngClass",e.WLB(18,f,!n.isFromCurrentUser,n.isFromCurrentUser)),e.xp6(2),e.Oqu(null==n.message?null:n.message.message))},dependencies:[i.mk,h],styles:[".user-info-input[_ngcontent-%COMP%]{height:2vh;margin:1rem .5rem 0rem;font-size:small;border:solid 1px #0D0F45;background-color:#0d0f45;color:#fff;border-radius:5px;padding:.5rem .5rem 1.5rem;overflow:hidden}.user-info-output[_ngcontent-%COMP%]{height:2vh;margin:1rem .5rem .5rem;font-size:small;border:solid 1px #0D0F45;background-color:#0d0f45;color:#fff;border-radius:5px;padding:.5rem .5rem 1.5rem;text-align:end;margin-left:auto;overflow:hidden}.message-date[_ngcontent-%COMP%]{height:2vh;margin:0rem .5rem .5rem;font-size:small;background-color:gray;color:#fff;border-radius:5px;padding:.5rem .5rem 1.5rem;overflow:hidden}.chat-message-input[_ngcontent-%COMP%]{clip-path:polygon(0% 0%,100% 0%,100% 75%,75% 75%,75% 100%,50% 75%,0% 75%);background-color:#fff;max-width:75%;padding:1rem .5rem 4.5rem 1rem;margin:0rem .5rem 1rem;font-size:small;border-radius:5px}.chat-message-output[_ngcontent-%COMP%]{clip-path:polygon(0% 0%,100% 0%,100% 75%,46% 75%,15% 100%,20% 75%,0% 75%);background-color:#fff;max-width:75%;padding:1rem .5rem 4.5rem 1rem;margin:0rem .5rem 1rem;font-size:small;border-radius:5px;margin-left:auto}.input-row[_ngcontent-%COMP%]{justify-content:start}.output-row[_ngcontent-%COMP%]{justify-content:end}@media (max-width: 475px){.chat-message-input[_ngcontent-%COMP%]{padding-bottom:6rem}}"]}),t})();var m=a(433);const M=function(t){return{disabledBtn:t}};let v=(()=>{class t{constructor(s){this.chat_messages=s,this.currentUserEmail="",this.messageText=""}ngOnInit(){}addMessage(){this.chat_messages.addDocument({message:this.messageText,from:this.currentUserEmail,to:"",timestamp:Date.now().toString()}).then(()=>this.messageText="")}}return t.\u0275fac=function(s){return new(s||t)(e.Y36(g))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-message-input"]],inputs:{currentUserEmail:"currentUserEmail"},decls:7,vars:5,consts:[[1,"container","mt-2"],[1,"row"],[1,"col-10","message-input","form-group"],["type","text",1,"form-control",3,"ngModel","ngModelChange"],[1,"col-2"],[1,"btn","btn-success",3,"ngClass","disabled","click"]],template:function(s,n){1&s&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"input",3),e.NdJ("ngModelChange",function(T){return n.messageText=T}),e.qZA()(),e.TgZ(4,"div",4)(5,"button",5),e.NdJ("click",function(){return n.addMessage()}),e._uU(6,"Enviar"),e.qZA()()()()),2&s&&(e.xp6(3),e.Q6J("ngModel",n.messageText),e.xp6(2),e.Q6J("ngClass",e.VKq(3,M,""==n.messageText))("disabled",""==n.messageText))},dependencies:[i.mk,m.Fj,m.JJ,m.On],styles:["button[_ngcontent-%COMP%]{width:100%}.disabledBtn[_ngcontent-%COMP%]:hover{cursor:not-allowed}"]}),t})();const b=["chatEnd"];function F(t,o){if(1&t&&e._UZ(0,"app-message",6),2&t){const s=o.$implicit,n=e.oxw();e.Q6J("message",s)("isFromCurrentUser",s.from==n.auth.GetCurrentUserEmail())}}let w=(()=>{class t{constructor(s,n,r){this.messagesService=s,this.auth=n,this.router=r,this.chatEnd={},this.messages=[]}ngOnInit(){this.messagesService.getDocuments().subscribe(s=>{this.messages=s.sort((n,r)=>Number(n.timestamp)-Number(r.timestamp)),setTimeout(()=>this.chatEnd.nativeElement.scrollIntoView(),100)})}}return t.\u0275fac=function(s){return new(s||t)(e.Y36(g),e.Y36(p.e),e.Y36(l.F0))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-message-board"]],viewQuery:function(s,n){if(1&s&&e.Gf(b,5),2&s){let r;e.iGM(r=e.CRH())&&(n.chatEnd=r.first)}},decls:6,vars:2,consts:[[1,"container"],[1,"message-window","scrollbar-info"],[3,"message","isFromCurrentUser",4,"ngFor","ngForOf"],["id","chat-end"],["chatEnd",""],[3,"currentUserEmail"],[3,"message","isFromCurrentUser"]],template:function(s,n){1&s&&(e.TgZ(0,"div",0)(1,"div",1),e.YNc(2,F,1,2,"app-message",2),e._UZ(3,"div",3,4),e.qZA(),e._UZ(5,"app-message-input",5),e.qZA()),2&s&&(e.xp6(2),e.Q6J("ngForOf",n.messages),e.xp6(3),e.Q6J("currentUserEmail",n.auth.GetCurrentUserEmail()))},dependencies:[i.sg,C,v],styles:[".message-window[_ngcontent-%COMP%]{height:65vh;border:solid 1px #0D0F45;margin-top:5vh;overflow-y:scroll;overflow-x:hidden}[_ngcontent-%COMP%]::-webkit-scrollbar{width:12px}[_ngcontent-%COMP%]::-webkit-scrollbar-track{-webkit-box-shadow:inset 0 0 6px rgba(0,0,0,.3);border-radius:1rem}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{border-radius:1rem;-webkit-box-shadow:inset 0 0 6px rgba(0,0,0,.5)}"]}),t})();const _=[{path:"",children:[{path:"",redirectTo:"chat-room",pathMatch:"full"},{path:"chat-room",component:(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(s){return new(s||t)},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-chat-room"]],decls:1,vars:0,template:function(s,n){1&s&&e._UZ(0,"app-message-board")},dependencies:[w]}),t})()}]}];let U=(()=>{class t{}return t.\u0275fac=function(s){return new(s||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[l.Bz.forChild(_),l.Bz]}),t})(),y=(()=>{class t{}return t.\u0275fac=function(s){return new(s||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[i.ez,U,m.u5]}),t})()}}]);